<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multi-Step Selection</title>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

    <!-- <link rel="stylesheet" href="styles.css"> -->


<style>
body {
    font-family: Arial, sans-serif;
    background-color: #f4f4f4;
    margin: 0;
    padding: 20px;
}

.container {
    max-width: 600px;
    margin: auto;
    padding: 20px;
    background: #fff;
    border-radius: 8px;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
}

/* Responsive styles */
@media (max-width: 600px) {
    .container {
        margin: 0 10px; /* Add margin on mobile devices */
    }

    /* Make the input full width on mobile */
    #labelInput {
        width: 100%;
        box-sizing: border-box; /* Include padding and border in width */
    }

    /* Align buttons next to each other */
    .button-container {
        display: flex;
        flex-direction: column; /* Stack buttons vertically */
    }

    .button-container button {
        width: auto; /* Keep buttons side by side */
        margin: 5px 0; /* Add some vertical margin */
    }
}

h1, h2 {
    color: #b31313;
}

.option-btn {
    margin: 10px;
    padding: 10px 15px;
    border: 2px solid #000000;
    border-radius: 10px;
    background: #fff;
    cursor: pointer;
    transition: all 0.3s ease; /* Add transition for smoothness */
}

.option-btn:hover {
    transform: scale(1.05); /* Slightly enlarge the button on hover */
}

p {
    font-size: 10px;
    font-weight: bold;
    font-style: italic;
}

.option-btn.selected {
    font-weight: bold;
    background-color: rgb(128, 4, 0);
    border: 2px solid rgb(128, 4, 0);
    border-radius: 10px;
    color: white;
}

select {
    margin: 10px 0;
    padding: 10px;
    width: 100%;
}

button {
    margin: 10px;
    padding: 10px 15px;
    cursor: pointer;
    background-color: #800400;
    border: none;
    border-radius: 10px;
}

.nav-btn {
    background: #800400;
    color: #fff;
}

.next-btn {
    background: #800400;
    color: #fff;
}

.saved-label {
    display: flex;
    align-items: center;
    margin-top: 10px;
}

.saved-label > div {
    flex-grow: 1;
    font-size: 10px; /* Set font size for saved labels */
}

.strikethrough {
    text-decoration: line-through;
    color: gray;
}

#step4 button{
    color: #fff;
    font-weight: bold;
}

#resultsContainer button:nth-of-type(1){
    background-color: rgb(4, 153, 28);
    color: #fff;
    font-weight: bold;
}
#resultsContainer button:nth-of-type(2){
    background-color: crimson;
    color: #fff;
    font-weight: bold;
}

/* Modal styles */
.modal {
    display: none; /* Hidden by default */
    position: fixed; /* Stay in place */
    z-index: 1; /* Sit on top */
    left: 0;
    top: 0;
    width: 100%; /* Full width */
    height: 100%; /* Full height */
    overflow: auto; /* Enable scroll if needed */
    background-color: rgb(0,0,0); /* Fallback color */
    background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
}

.modal-content {
    background-color: #fefefe;
    margin: 15% auto; /* 15% from the top and centered */
    padding: 20px;
    border: 1px solid #888;
    width: 80%; /* Could be more or less, depending on screen size */
}

.close {
    color: #aaa;
    float: right;
    font-size: 28px;
    font-weight: bold;
}

.close:hover,
.close:focus {
    color: black;
    text-decoration: none;
    cursor: pointer;
}

/* Styles for final label */
.final-steps {
    font-weight: bold;
    color: #333; /* Change color as needed */
}

.final-label {
    margin-top: 5px;
    font-size: 10px; /* Adjust font size if necessary */
    color: #555; /* Change color as needed */
}

</style>
</head>
<body>
    <div class="container">
        <h1>Save Your Search Locations</h1>

        <div class="step" id="step1">
            <h2>Step 1: Select the Tire</h2>
            <p>1 - Main Section 2- Teen Section 3- Young Adult Section</p>
            <button class="option-btn" onclick="selectButton(1)">1</button>
            <button class="option-btn" onclick="selectButton(2)">2</button>
            <button class="option-btn" onclick="selectButton(3)">3</button>
            <button class="next-btn" onclick="goToStep('step2')">Next</button>
        </div>

        <div class="step" id="step2" style="display: none;">
            <h2>Step 2: Choose a Floor Number</h2>
            <select id="numberDropdown"></select>
            <button class="nav-btn" onclick="goToStep('step1')">Back</button>
            <button class="next-btn">Next</button>
        </div>

        <div class="step" id="step3" style="display: none;">
            <h2>Step 3: Choose a Self Number</h2>
            <select id="additionalDropdown"></select>
            <button class="nav-btn" onclick="goToStep('step2')">Back</button>
            <button class="next-btn" onclick="goToStep('step4')">Next</button>
        </div>

        <div class="step" id="step4" style="display: none;">
            <h2>Step 4: Choose Front or Back</h2>
            <p>(<span style="font-weight: bold; color: red;">A</span> front Side and <span style="font-weight: bold; color: red;">B</span> Back Side of the Shelf)</p>
            <button onclick="selectOption('A')">A</button>
            <button onclick="selectOption('B')">B</button>
            <button class="nav-btn" onclick="goToStep('step3')">Back</button>
        </div>

        <div class="step" id="step5" style="display: none;">
            <h2>Step 5: Enter the Book Code</h2>
            <input type="text" id="labelInput" placeholder="Enter a label for your selection" />
            <div class="button-container">
                <button class="nav-btn" onclick="goToStep('step4')">Back</button>
                <button class="next-btn" onclick="goToStep('step6')">Next</button>
            </div>
        </div>
        

        <div class="step" id="step6" style="display: none;">
            <h2>Step 6: Confirm Your Choice</h2>
            <h3 id="finalChoice"></h3>
            <button onclick="saveSelection()">SAVE</button>
            <button class="nav-btn" onclick="goToStep('step5')">Back</button>
        </div>

        <h2>Your Selections:</h2>
        <div id="resultsContainer"></div>
    </div>

    <!-- Modal Structure -->
    <div id="modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            <p>Only 6 selections allowed to borrow in a day!</p>
        </div>
    </div>

    <!-- <script src="script.js"></script> -->
<script>
let selectedNumber = null;
let additionalOption = null;
let selectedButton = null;
let finalOption = null;
let labelInput = '';
let savedSelections = [];

// Handle button selection in Step 1
function selectButton(buttonNumber) {
    const buttons = document.querySelectorAll('.option-btn');
    buttons.forEach(btn => btn.classList.remove('selected'));

    const selectedBtn = buttons[buttonNumber - 1];
    selectedBtn.classList.add('selected');
    selectedButton = buttonNumber;

    populateNumberDropdown(buttonNumber);
}

// Populate the number dropdown based on selected section
function populateNumberDropdown(buttonNumber) {
    const numberDropdown = document.getElementById('numberDropdown');
    numberDropdown.innerHTML = ''; // Clear existing options

    const defaultOption = document.createElement('option');
    defaultOption.textContent = 'Select a number';
    defaultOption.value = '';
    numberDropdown.appendChild(defaultOption);

    let options = [];
    if (buttonNumber === 1) options = Array.from({ length: 14 }, (_, i) => i + 1);
    else if (buttonNumber === 2) options = Array.from({ length: 10 }, (_, i) => i + 1);
    else if (buttonNumber === 3) options = Array.from({ length: 5 }, (_, i) => i + 1);

    options.forEach(num => {
        const option = document.createElement('option');
        option.value = num;
        option.textContent = num;
        numberDropdown.appendChild(option);
    });

    numberDropdown.onchange = () => {
        selectedNumber = numberDropdown.value;
        if (selectedNumber) {
            goToStep('step3');
        }
    };
}

// Populate the additional dropdown based on selected section
function populateAdditionalDropdown() {
    const additionalDropdown = document.getElementById('additionalDropdown');
    additionalDropdown.innerHTML = ''; // Clear existing options

    const defaultOption = document.createElement('option');
    defaultOption.textContent = 'Select an option';
    defaultOption.value = '';
    additionalDropdown.appendChild(defaultOption);

    let options = [];
    if (selectedButton) options = Array.from({ length: 14 }, (_, i) => i + 1);

    options.forEach(option => {
        const opt = document.createElement('option');
        opt.value = option;
        opt.textContent = option;
        additionalDropdown.appendChild(opt);
    });

    additionalDropdown.onchange = () => {
        additionalOption = additionalDropdown.value;
        if (additionalOption) {
            goToStep('step4');
        }
    };
}

// Handle option selection in Step 4
function selectOption(option) {
    finalOption = option;
    goToStep('step5');
}

// Transition between steps
function goToStep(stepId) {
    const steps = document.querySelectorAll('.step');
    steps.forEach(step => step.style.display = 'none');

    document.getElementById(stepId).style.display = 'block';

    if (stepId === 'step2') {
        populateNumberDropdown(selectedButton);
    } else if (stepId === 'step3') {
        populateAdditionalDropdown();
    } else if (stepId === 'step5') {
        document.getElementById('labelInput').value = ''; // Reset label input field
    } else if (stepId === 'step6') {
        displayFinalChoices();
    }
}

// Prepare the final choice with the label input
function prepareFinalChoice() {
    labelInput = document.getElementById('labelInput').value.trim();
    return {
        text: `TIRE: ${selectedButton}. FLOOR: ${selectedNumber}. SHELF: ${additionalOption}.${finalOption}`,
        labelInput: labelInput, // Store the label input separately
        done: false
    };
}

// Display final choices for confirmation
function displayFinalChoices() {
    const finalChoiceContainer = document.getElementById('finalChoice');
    finalChoiceContainer.innerHTML = ''; // Clear previous content

    const finalSelection = prepareFinalChoice();
    const stepsLine = `TIRE: ${selectedButton}. FLOOR: ${selectedNumber}. SHELF: ${additionalOption}.${finalOption}`;
    const labelLine = `Book Code: ${labelInput}`;

    finalChoiceContainer.innerHTML = `
        <div class="final-steps">${stepsLine}</div>
        <div class="final-label">${labelLine}</div>
    `;
}

// Save the current selection
function saveSelection() {
    if (savedSelections.length >= 6) {
        openModal();
        return;
    }

    const selection = prepareFinalChoice();
    savedSelections.push(selection);
    localStorage.setItem('userSelections', JSON.stringify(savedSelections));
    displaySavedSelections();

    resetSteps();
}

// Display all saved selections
function displaySavedSelections() {
    const resultsContainer = document.getElementById('resultsContainer');
    resultsContainer.innerHTML = '';

    savedSelections.forEach((selection, index) => {
        const labelDiv = document.createElement('div');
        labelDiv.className = 'saved-label';

        const stepsLine = selection.text; // Access the text directly
        const labelLine = `Book Code: ${selection.labelInput}`; // Use the stored labelInput

        const label = document.createElement('div');
        label.innerHTML = `<div>${stepsLine}</div><div>${labelLine}</div>`;
        if (selection.done) {
            label.style.textDecoration = "line-through";
        }

        const doneButton = document.createElement('button');
        doneButton.innerHTML = `<i class="fas fa-check"></i> DONE`;
        doneButton.onclick = () => markDone(index);

        const delButton = document.createElement('button');
        delButton.innerHTML = `<i class="fas fa-trash"></i> DEL`;
        delButton.onclick = () => deleteSelection(index);

        labelDiv.appendChild(label);
        labelDiv.appendChild(doneButton);
        labelDiv.appendChild(delButton);

        resultsContainer.appendChild(labelDiv);
    });
}

// Mark a selection as done
function markDone(index) {
    // Toggle the done status safely
    if (savedSelections[index]) {
        savedSelections[index].done = !savedSelections[index].done; // Toggle the done status
        displaySavedSelections(); // Refresh the display
    }
}

// Delete a saved selection
function deleteSelection(index) {
    // Check if the index is valid before deleting
    if (index >= 0 && index < savedSelections.length) {
        savedSelections.splice(index, 1); // Remove the selection at the index
        localStorage.setItem('userSelections', JSON.stringify(savedSelections)); // Update local storage
        displaySavedSelections(); // Refresh the display
    }
}

// Open modal for maximum selections
function openModal() {
    document.getElementById('modal').style.display = 'block';
}

// Close modal
function closeModal() {
    document.getElementById('modal').style.display = 'none';
}

// Reset steps for new selection
function resetSteps() {
    selectedNumber = null;
    additionalOption = null;
    selectedButton = null;
    finalOption = null;
    labelInput = ''; // Reset label input
    const steps = document.querySelectorAll('.step');
    steps.forEach(step => step.style.display = 'none');
    goToStep('step1'); // Reset to first step
}

// Load previous selections on page load
window.onload = function() {
    const savedSelection = localStorage.getItem('userSelections');
    if (savedSelection) {
        savedSelections = JSON.parse(savedSelection);
        console.log('Loaded saved selections:', savedSelections); // Log loaded selections
        displaySavedSelections();
    }
};

</script>
</body>
</html>
